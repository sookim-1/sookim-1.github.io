<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Sookim-1 😁</title><description>iOS개발 블로그</description><link>https://sookim-1.github.io</link><language>ko</language><lastBuildDate>Sun, 28 Jan 2024 23:14:11 +0000</lastBuildDate><pubDate>Sun, 28 Jan 2024 23:14:11 +0000</pubDate><ttl>250</ttl><atom:link href="https://sookim-1.github.io/feed.rss" rel="self" type="application/rss+xml"/><item><guid isPermaLink="true">https://sookim-1.github.io/posts/SNS%EB%A1%9C%EA%B7%B8%EC%9D%B8%201%ED%83%84-%EC%B9%B4%EC%B9%B4%EC%98%A4,%20%EB%84%A4%EC%9D%B4%EB%B2%84</guid><title>카카오 로그인</title><description>SNS Login</description><link>https://sookim-1.github.io/posts/SNS%EB%A1%9C%EA%B7%B8%EC%9D%B8%201%ED%83%84-%EC%B9%B4%EC%B9%B4%EC%98%A4,%20%EB%84%A4%EC%9D%B4%EB%B2%84</link><pubDate>Wed, 10 Jan 2024 11:10:00 +0000</pubDate><content:encoded><![CDATA[<p>안녕하세요 sookim입니다~! 👋</p><br></br><p>해당 포스팅은 SNS로그인에 관하여 작성해보려고 합니다.</p><p>SNS로그인은 다양한 SDK가 있는데 그 중 <strong>카카오</strong>, <strong>네이버</strong>, <strong>페이스북</strong>, <strong>구글</strong>, <strong>깃허브</strong> 로그인등을 구현해보고 애플의 심사지침 중 <code>앱 내에서 소셜로그인 서비스를 사용한다면 애플로그인을 제공해야 한다.</code>라는 지침이 있기 때문에 애플로그인도 함께 구현해보겠습니다.</p><h1>카카오 로그인</h1><p>카카오 로그인을 구현하기 위해서 <a href="https://developers.kakao.com/">KakaoDeveloper</a> 이동하여 카카오계정 로그인을 진행합니다.</p><p><a href="https://developers.kakao.com/docs/latest/ko/ios/getting-started">Kakao SDK for iOS 사용방</a>법을 참고하여 요구사양 확인, <a href="https://developers.kakao.com/docs/latest/ko/getting-started/app#platform">플랫폼등록</a>, SDK 설치를 진행합니다.</p><br></br><p>⚠️ 위 단계 진행시 참고할 부분은 3가지 정도가 있습니다.</p><ol><li>카카오디벨로퍼스 앱 설정에서 카카오로그인을 활성화를 진행해야합니다. <img src="../../Resources/images/DocsImages/kakao1.png" alt="kakao1.png"/></li><li>info.plist의 앱실행허용목록 키값 추가할 때 문서 또는 코드로 작성하는 경우 LSApplicationQueriesSchemes로 키값을 명시하지만 Queried URL Schemes로 키값이 명시됩니다. <img src="../../Resources/images/DocsImages/kakao2.png" alt="kakao2.png"/></li><li>카카오SDK 초기화 코드 및 커스텀 스킴에 API Key노출이 되지않도록 주의합니다. <img src="../../Resources/images/DocsImages/kakao3.png" alt="kakao3.png"/> <img src="../../Resources/images/DocsImages/kakao4.png" alt="kakao4.png"/></li></ol><hr><p>위의 SDK 설정작업이 모두 완료되었다면 카카오로그인기능을 구현합니다.</p><p>💡 주요 메서드 확인</p><ul><li><a href="<https://developers.kakao.com/sdk/reference/ios/release/KakaoSDKUser/documentation/kakaosdkuser/userapi/iskakaotalkloginavailable()/>">isKakaoTalkLoginAvailable()</a> : 카카오톡 간편로그인 실행 가능여부</li><li><a href="<https://developers.kakao.com/sdk/reference/ios/release/KakaoSDKUser/documentation/kakaosdkuser/userapi/loginwithkakaotalk(launchmethod:channelpublicids:serviceterms:nonce:completion:)/>">loginWithKakaoTalk(launchMethod:channelPublicIds:serviceTerms:nonce:completion:)</a> : 카카오톡 간편로그인 실행</li><li><a href="<https://developers.kakao.com/sdk/reference/ios/release/KakaoSDKUser/documentation/kakaosdkuser/userapi/loginwithkakaoaccount(prompts:loginhint:nonce:completion:)>">loginWithKakaoAccount()</a> : 카카오 웹로그인 실행<ul><li>iOS 11 이상에서 제공되는 (SF/ASWeb)AuthenticationSession 을 이용하여 로그인 페이지를 띄우고 쿠키 기반 로그인을 수행합니다. 이미 사파리에에서 로그인하여 카카오계정의 쿠키가 있다면 이를 활용하여 ID/PW 입력 없이 간편하게 로그인할 수 있습니다.</li></ul></li></ul><hr><h1>네이버 로그인</h1><p>네이버 로그인을 구현하기 위해서 <a href="https://developers.naver.com/main/">NaverDevelopers</a>로 이동하여 네이버계정 로그인을 진행합니다.</p><p><a href="https://developers.naver.com/products/login/api/api.md">네이버로그인 서비스 소개페이지</a>를 확인한 후 오픈 API이용 신청을 위해 애플리케이션을 등록합니다.</p><ul><li><a href="https://developers.naver.com/docs/common/openapiguide/appregister.md#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%93%B1%EB%A1%9D">애플리케이션 등록 세부사항</a></li><li>네이버로그인은 검수를 통과해야 모든 사용자가 로그인 할 수 있고 검수를 미진행 상태인 경우에는 멤버관리 탭에서 등록한 계정으로만 로그인이 가능합니다.</li></ul><p><a href="https://developers.naver.com/docs/login/ios/ios.md">iOS용 네이버로그인 라이브러리</a>는 Objective-C언어로 구현이 되어 있어 UIKit에서 사용하는 방법을 단계별로 설명하겠습니다.</p><p>🚨 iOS용 네이버로그인 라이브러리는 Objective-C언어로 구현이 되어 있습니다. 라이브러리 내부의 헤더파일(NaverThirdPartyConstantsForApp.h)에 관련 정보들을 작성해야 하는데 SPM에서 값을 수정할 수 없는 것 같고 SPM을 공식적으로 지원하지 않아 CocoaPod으로 설치를 진행합니다.</p><ol><li>기존의 APIKey관련 값들을 xcconfig파일로 관리하고 있어서 Pod설치를 하여 Pods~.xcconfig에 자동으 로 include하도록 post install 스크립트를 작성한 후 sdk도 함께 설치합니다.<ul><li>SNSLogin프로젝트의 Podfile 참고 2. Build Phase에서 xcconfig파일을 참고하여 자동으로 NaverThirdPartyConstantsForApp.h의 값들을 변경하도록 합니다.</li><li><a href="https://github.com/sookim-1/iOS_ThirdParty_Projects">SNSLogin프로젝트</a>의 Build Phase 참고 3. info.plist의 앱실행허용목록 키값 추가 - LSApplicationQueriesSchemes <img src="../../Resources/images/DocsImages/naver1.png" alt="naver1.png"/> 4. URL Schemes 설정 - 애플리케이션 등록에 설정한 값 (소문자로만 구성하도록 권장) <img src="../../Resources/images/DocsImages/naver2.png" alt="naver2.png"/> 5. AppDelegate.swift에서 각종 관련 설정</li></ul></li></ol><pre><code class="language-swift">   import NaverThirdPartyLogin
   
   @main
   class AppDelegate: UIResponder, UIApplicationDelegate {
        func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {
                
            settingNaverSNSLogin()
            
            return true
        }
        
        func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey : Any] = [:]) -&gt; Bool {
            NaverThirdPartyLoginConnection.getSharedInstance().application(app, open: url, options: options)
            
            return true
        }
        
        func settingNaverSNSLogin() {
            // 네이버 앱 간편로그인 활성화
            NaverThirdPartyLoginConnection.getSharedInstance()?.isNaverAppOauthEnable = true
            
            // 네이버 웹 로그인 활성화
            NaverThirdPartyLoginConnection.getSharedInstance()?.isInAppOauthEnable = true
            
            // 네이버 로그인 세로모드 고정
            NaverThirdPartyLoginConnection.getSharedInstance().setOnlyPortraitSupportInIphone(true)
            
            // NaverThirdPartyConstantsForApp.h에 선언한 상수 등록
            NaverThirdPartyLoginConnection.getSharedInstance().serviceUrlScheme = SNSConfigurations.getValueFor(.naverAppURLScheme)
            NaverThirdPartyLoginConnection.getSharedInstance().consumerKey = SNSConfigurations.getValueFor(.naverConsumerKey)
            NaverThirdPartyLoginConnection.getSharedInstance().consumerSecret = SNSConfigurations.getValueFor(.naverConsumerSecret)
            NaverThirdPartyLoginConnection.getSharedInstance().appName = SNSConfigurations.getValueFor(.naverAppName)
        }
   }
</code></pre><ol start="7"><li>(SceneDelegate가 구현되어 있다면 설정)</li></ol><pre><code class="language-swift">   class SceneDelegate: UIResponder, UIWindowSceneDelegate {
        func scene(_ scene: UIScene, openURLContexts URLContexts: Set&lt;UIOpenURLContext&gt;) {
            NaverThirdPartyLoginConnection.getSharedInstance()?.receiveAccessToken(URLContexts.first?.url)
        }
   }
</code></pre><ol start="8"><li>로그인 동작을 원하는 곳에 NaverThirdPartyLoginConnectionDelegate를 채택한 후 requestThirdPartyLogin()메서드를 실행해줍니다.</li></ol><pre><code class="language-swift">   import NaverThirdPartyLogin
   
   class SNSLoginViewController: UIViewController {
   
        let loginInstance = NaverThirdPartyLoginConnection.getSharedInstance()
   
        override func viewDidLoad() {
           super.viewDidLoad()
   
                naverLoginButton.rx.tap.bind { [weak self] in
                    guard let self
                    else { return }
                    
                    loginInstance?.delegate = self
                    loginInstance?.requestThirdPartyLogin()
                }
                .disposed(by: disposeBag)
        }
   }
   
   extension SNSLoginViewController: NaverThirdPartyLoginConnectionDelegate {
       
       // 로그인 버튼을 눌렀을 경우 열게 될 브라우저
       func oauth20ConnectionDidOpenInAppBrowser(forOAuth request: URLRequest!) {
           print("open")
       }
       
       // 로그인에 성공했을 경우 호출
       func oauth20ConnectionDidFinishRequestACTokenWithAuthCode() {
           print("[Success] : Success Naver Login")
           
           self.pushToSuccessViewController(successText: "네이버로그인 성공")
       }
       
       // 접근 토큰 갱신
       func oauth20ConnectionDidFinishRequestACTokenWithRefreshToken() {
           print("token refresh")
       }
       
       // 로그아웃 할 경우 호출(토큰 삭제)
       func oauth20ConnectionDidFinishDeleteToken() {
           loginInstance?.requestDeleteToken()
       }
       
       // 모든 Error
       func oauth20Connection(_ oauthConnection: NaverThirdPartyLoginConnection!, didFailWithError error: Error!) {
           print("[Error] :", error.localizedDescription)
       }
       
   }
</code></pre><hr>]]></content:encoded></item></channel></rss>
<!doctype html><html lang="en" data-bs-theme="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Firebase 프로젝트를 Debug, Release 별로 나누어 사용 중인 경우 FCM Token관리가 중요하다. 기기에서 빌드환경이 Debug로 설치된 상태에서 Release로 앱을 다시설치하는 경우 FCM Token이 변경될 수 있다."><meta name="author" content="sookim-1"><meta name="generator" content="Ignite v0.2.1"><title>번호: 010, 작성일자: 2024-03-11 – My T.W.L Site</title><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/bootstrap-icons.min.css" rel="stylesheet"><link href="https://sookim-1.github.io/ko/010-20240311" rel="canonical"><link href="/images/favicon.png" rel="icon"><meta property="og:site_name" content="sookim-1"><meta property="og:title" content="번호: 010, 작성일자: 2024-03-11"><meta property="twitter:title" content="번호: 010, 작성일자: 2024-03-11"><meta property="og:description" content="번호: 010, 작성일자: 2024-03-11"><meta name="twitter:description" content="번호: 010, 작성일자: 2024-03-11"><meta property="og:url" content="https://sookim-1.github.io/ko/010-20240311"><meta name="twitter:domain" content="sookim-1.github.io"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:dnt" content="on"></head><body class="container" style="padding-top: 80px; padding-bottom: 80px"><div class="col-sm-10 mx-auto"><h1>번호: 010, 작성일자: 2024-03-11</h1><p><h2>2024.03.04 ~ 2024.03.10</h2><h3>🔄 FCM Token 갱신</h3><hr /><p>Firebase 프로젝트를 Debug, Release 별로 나누어 사용 중인 경우 FCM Token관리가 중요하다. 기기에서 빌드환경이 Debug로 설치된 상태에서 Release로 앱을 다시설치하는 경우 FCM Token이 변경될 수 있다.</p><p>fcmToken의 값이 변경되는 시점은 아래 4가지 경우이다.</p><ul><li>새 기기에서 앱 복원</li><li>사용자가 앱 제거/재설치</li><li>사용자가 앱 데이터 소거</li><li>앱이 인스턴스 ID를 삭제</li></ul><p>FCM을 직접 갱신하기 위해서는 삭제 후 조회를 하면 된다. 아래코드는 FCM 토큰을 직접갱신하는 코드인데, 삭제는 옵셔널이다.</p><pre><code class="language-swift">// FCM 토큰 삭제
Messaging.messaging().deleteToken { error in
    print(error)
}

// FCM 토큰 조회
Messaging.messaging().token { token, error in
  if let error = error {
    print("Error fetching FCM registration token: \(error)")
  } else if let token = token {
    print("FCM registration token: \(token)")
  }
}
</code></pre><h3>📱 CollectionView Compositional Layout</h3><hr /><p>반복되는 데이터를 표시하는 경우와 추후 확장성을 위해서는 CollectionView Compositional Layout를 사용할 수 있다. CollectionView Compositional Layout을 사용할 때는 기본적인 UICollectionViewDataSource와 사용할 수 도 있고 UICollectionViewDiffableDataSource와도 사용할 수 있다. UICollectionReusableView를 사용하여 각 섹션별 Header, Footer를 구현하는 경우, viewForSupplementaryElementOfKind 메서드에서 조건문을 조심하지 않으면 재사용되기 때문에 주의해서 사용해야겠다.</p><h3>🚀 FireStore 사용 시 빌드시간 증가 이슈</h3><hr /><p>지지난 주 FireStore를 사용하는 프로젝트의 경우 빌드시간이 기하급수적으로 증가한 이유에 대해서 확인해보았는데 일단 FireStore를 사용한다면 빌드시간이 엄청나게 증가한 것은 확인했다. 빌드시간 단축을 위해 찾아본 결과 FireStore는 C++로 구성된 파일이 많은데 Xcode로 빌드하는 경우 컴파일할 때 시간이 증가할 수 있다는 내용을 <a href="https://github.com/invertase/firestore-ios-sdk-frameworks">FireStore iOS SDK 저장소</a>의 ReadMe에서 확인을 했다.</p><ul><li>기존의 pod 설치 명령어는 <code>pod 'FirebaseFirestore', '10.19.0'</code> 이였다.</li><li>변경된 pod 설치 명령어는 <code>pod 'FirebaseFirestore', :git => '<https://github.com/invertase/firestore-ios-sdk-frameworks.git>', :tag => '10.19.0'</code> 로 변경했다.</li></ul><p>빌드시간이 FireStore로 변경 전과 유사하게 줄어들었다. 즉, 미리 컴파일된 바이너리파일에서 FireStore를 사용하도록 변경한 것이다.</p><h3>🙋🏻‍♂️ 기타 사항</h3><hr /><ol><li>깃허브 블로그를 Swift언어를 사용한 Publish라이브러리를 사용하여 배포 중인데 마크다운 문법 중 특정 이모지를 사용하면 배포 workflow가 실패하는 부분이 있어서 해당 부분을 수정했다.</li></ol></p><div><h3><a href="/tags/i-o-s" rel="tag"><span class="badge text-bg-primary rounded-pill" style="margin-right: 5px">iOS</span></a><a href="/tags/swift" rel="tag"><span class="badge text-bg-primary rounded-pill" style="margin-right: 5px">Swift</span></a><a href="/tags/firebase" rel="tag"><span class="badge text-bg-primary rounded-pill" style="margin-right: 5px">Firebase</span></a><a href="/tags/f-c-m-token" rel="tag"><span class="badge text-bg-primary rounded-pill" style="margin-right: 5px">FCM Token</span></a><a href="/tags/collection-view" rel="tag"><span class="badge text-bg-primary rounded-pill" style="margin-right: 5px">CollectionView</span></a></h3></div></div><script src="/js/bootstrap.bundle.min.js"></script></body></html>